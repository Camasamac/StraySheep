[gd_scene load_steps=5 format=2]

[ext_resource path="res://Assets/Player/apollo sprite v2-Sheet2.png" type="Texture" id=2]

[sub_resource type="GDScript" id=3]
script/source = "extends KinematicBody2D

const UP = Vector2(0,-1)

onready var playernode = get_node(\"res://Assets/Player/2DPlayer.tscn\")
export(String) var scene_to_load

var gravity = 50 # Gravity's strength.
const movement_speed = 200 # Determines the base movement speed of the player.
const maximum_jumpPower = -1000.0 # How much force used to make player high jump.
const minimum_jumpPower = -600.0 # How much force used to make the player small jump.

var velocity = Vector2()

# Called when the node enters the scene tree for the first time.
func _ready():
	pass # Replace with function body.

func _physics_process(delta):
	velocity.y += gravity
	var isMoving: bool = false
	
	# Player movement code for pressing 'left' and 'right'.
	if Input.is_action_pressed(\"ui_left\"):
		velocity.x = -movement_speed
		$AnimationPlayer.stop()
		isMoving = true
	elif Input.is_action_pressed(\"ui_right\"):
		velocity.x = movement_speed
		$AnimationPlayer.stop()
		isMoving = true
	else:
		velocity.x = 0
	
	if(!isMoving):
		$AnimationPlayer.play(\"Idle\")
	
	# As long as the player is touching a floor, they can jump using the space bar button.
	if is_on_floor():
		if Input.is_action_pressed(\"ui_jump\"):
			velocity.y = maximum_jumpPower
			isMoving = true
	
	# This portion of the jumping code allows for the player to 'short hop'.
	if Input.is_action_just_released(\"ui_jump\") && velocity.y < 0:
		velocity.y = 0
	
	if Input.is_action_pressed(\"ui_up\"):
		print(\"go up\")
		#velocity.y -= 100
		if Global.player_depth < 7:
			Global.player_depth += 1
			if Input.is_action_pressed(\"ui_up\"):
				set_collision_layer_bit(Global.player_depth + 1, true)
				get_collision_layer_bit(Global.player_depth)
			if Input.is_action_just_released(\"ui_up\"):
				set_collision_layer_bit(Global.player_depth + 1, false)
				set_collision_layer_bit(Global.player_depth, true)
				# what makes it so i can go down?!
		#if Global.player_depth == 7:
			#set_collision_layer_bit(7, true)
		print(Global.player_depth)
		
	if Input.is_action_pressed(\"ui_down\"):
		print(\"go down\")
		#velocity.y += 50
		# The above code will allow the player to fly when they enable jumping, could be used later.
		if Global.player_depth > 1:
			Global.player_depth -= 1
			if Input.is_action_pressed(\"ui_down\"):
				set_collision_layer_bit(Global.player_depth - 1, true)
				get_collision_layer_bit(Global.player_depth)
			if Input.is_action_just_released(\"ui_down\"):
				set_collision_layer_bit(Global.player_depth - 1, false)
				set_collision_layer_bit(Global.player_depth, true)
		#if Global.player_depth == 1:
			#set_collision_layer_bit(1, true)
		print(Global.player_depth)
	
	#print(velocity.y)
	move_and_slide(velocity , UP)
"

[sub_resource type="RectangleShape2D" id=1]
extents = Vector2( 24.8516, 52.0938 )

[sub_resource type="Animation" id=2]
resource_name = "Idle"
length = 0.8
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath("Player Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.2, 0.4, 0.6 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 1,
"values": [ 0, 4, 6, 4 ]
}

[node name="2DPlayer" type="KinematicBody2D"]
script = SubResource( 3 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( 0, -6 )
shape = SubResource( 1 )

[node name="Player Sprite" type="Sprite" parent="."]
position = Vector2( 0, -7 )
texture = ExtResource( 2 )
hframes = 9
vframes = 3

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
anims/Idle = SubResource( 2 )

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2( 0, 50 )
current = true
drag_margin_h_enabled = true
drag_margin_v_enabled = true
smoothing_enabled = true
__meta__ = {
"_editor_description_": "Everything contained within the Pink Border is the camera in the game."
}
